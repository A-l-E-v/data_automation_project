2025-08-26 13:57:06,307 | INFO    | src.utils.logging:70 - Логирование настроено. Файл: logs/app.log, уровень: INFO
2025-08-26 13:57:06,331 | INFO    | src.pipelines.runner:19 - Старт конвейера
2025-08-26 13:57:06,436 | INFO    | src.io.sql:39 - SQL loaded: shape=(1000, 4); query=SELECT order_id, customer_id, order_date, amount FROM sales
2025-08-26 13:57:06,437 | INFO    | src.pipelines.io_stage:59 - Загружено из SQL: sales rows=1000
2025-08-26 13:57:06,467 | INFO    | src.io.sql:39 - SQL loaded: shape=(1000, 5); query=SELECT s.order_id, s.customer_id, s.order_date, s.amount, c.country FROM sales s JOIN customers c ON s.customer_id = ...
2025-08-26 13:57:06,467 | INFO    | src.pipelines.io_stage:59 - Загружено из SQL: sales_join_country rows=1000
2025-08-26 13:57:06,468 | INFO    | src.pipelines.io_stage:17 - Загрузка CSV: data/raw/sales.csv
2025-08-26 13:57:06,473 | INFO    | src.io.loader:19 - CSV loaded: data/raw/sales.csv shape=(1000, 4)
2025-08-26 13:57:06,475 | INFO    | src.pipelines.io_stage:17 - Загрузка CSV: data/raw/customers.csv
2025-08-26 13:57:06,477 | INFO    | src.io.loader:19 - CSV loaded: data/raw/customers.csv shape=(200, 2)
2025-08-26 13:57:06,478 | INFO    | src.pipelines.io_stage:26 - Загрузка Excel: data/raw/sales.xlsx:Sheet1
2025-08-26 13:57:06,734 | INFO    | src.io.loader:35 - Excel loaded: data/raw/sales.xlsx sheet=Sheet1 shape=(1000, 4)
2025-08-26 13:57:06,735 | INFO    | src.pipelines.io_stage:36 - Вызов API: http://127.0.0.1:5000/sales method=GET json_root=data paginate=False
2025-08-26 13:57:06,744 | INFO    | src.io.loader:157 - API returned 200 rows, 4 cols
2025-08-26 13:57:06,748 | INFO    | src.pipelines.runner:23 - Concat all -> shapes: sales=(4400, 6) users=(0, 0) products=(0, 0)
2025-08-26 13:57:06,755 | INFO    | src.pipelines.runner:35 - Диапазон дат: 2024-08-21 00:00:00 — 2025-08-26 00:00:00; валюта: руб.
2025-08-26 13:57:06,756 | INFO    | src.pipelines.runner:38 - Распределение строк по источникам: {'file': 2200, 'db': 2000, 'api': 200}
2025-08-26 13:57:06,765 | INFO    | src.pipelines.clean_stage:70 - drop_high_missing_columns: ничего не удалено (threshold=0.80)
2025-08-26 13:57:06,771 | INFO    | src.pipelines.runner:43 - Очистка готова: stats={'sales_duplicates': 1000, 'sales_missing': {'order_id': 200, 'customer_id': 0, 'order_date': 200, 'amount': 200, 'country': 3200}}
2025-08-26 13:57:07,056 | INFO    | src.ml.classification:66 - ML[classification] {'target': 'high_value_q0.80', 'accuracy': 0.6290909090909091, 'precision': 0.26869158878504673, 'recall': 0.5476190476190477, 'f1': 0.3605015673981191, 'roc_auc': 0.6227554842161583, 'n_train': 3300, 'n_test': 1100}
2025-08-26 13:57:08,342 | INFO    | src.ml.regression:37 - Регрессия: признаков=5
2025-08-26 13:57:12,713 | INFO    | src.ml.regression:51 - ML[regression] {'rmse': 69.63419491587115, 'mae': 50.47193326729926, 'r2': 0.10906385432862997, 'n_train': 3150, 'n_test': 1050}
2025-08-26 13:57:14,164 | INFO    | src.pipelines.runner:54 - ML метрики: {'classification': {'target': 'high_value_q0.80', 'accuracy': 0.6290909090909091, 'precision': 0.26869158878504673, 'recall': 0.5476190476190477, 'f1': 0.3605015673981191, 'roc_auc': 0.6227554842161583, 'n_train': 3300, 'n_test': 1100}, 'regression': {'rmse': 69.63419491587115, 'mae': 50.47193326729926, 'r2': 0.10906385432862997, 'n_train': 3150, 'n_test': 1050}}
2025-08-26 13:57:20,261 | INFO    | src.reporting.report_stage.stage:89 - Агрегаты по источникам:
source  rows  amount_sum  amount_mean
   api   200    13689.81     68.44905
    db  2000   169506.52     84.75326
  file  2200   169506.52     84.75326
2025-08-26 13:57:20,830 | INFO    | src.reporting.email:64 - Email успешно отправлен.
2025-08-26 13:57:20,830 | INFO    | src.pipelines.email_stage:47 - email: письмо отправлено (вложений: 18)
2025-08-26 13:57:20,831 | INFO    | src.pipelines.runner:73 - email: письмо отправлено
2025-08-26 13:57:20,831 | INFO    | src.pipelines.runner:98 - Конвейер завершён
